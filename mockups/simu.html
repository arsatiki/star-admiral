<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
    <title>Battle Simulator</title>
    
    <link rel="stylesheet" href="css/simu.css" type="text/css"
          media="screen" title="no title" charset="utf-8">

    <script type="text/javascript" src="js/utils.js"></script>
    <script type="text/javascript" src="js/ships.js"></script>
    
    <script type="text/javascript" charset="utf-8">
        function beam1(c, sources, tgx, tgy, ws, styles) {
            var sid, bid;

            c.beginPath();

            for (bid = 0; bid < ws.length; bid++) {
                c.lineWidth = ws[bid];
                c.strokeStyle = styles[bid];
                
                for (sid = 0; sid < sources.length; sid += 2) {
                    c.moveTo(sources[sid], sources[sid+1]);
                    
                    c.save();
                    c.setTransform(1, 0, 0, 1, 0, 0);
                    c.lineTo(tgx, tgy);
                    c.restore();
                }

                c.stroke();
            }
            
            //console.log("I did it!");
        }
        
        function beam(c, sources, tgx, tgy, sigma) {
            c.lineCap = "round";
            tgx += sigma * Math.random();
            tgy += sigma * Math.random();
            beam1(c, sources, tgx, tgy, [3, 1.5], ["#f00", "#fff"]);
        }
    </script>
    
    <script type="text/javascript" charset="utf-8">
    function run() {
        console.log("Go");
        return;
        var c = document.getElementById("canv").getContext("2d");
        var frameRate = 30;
        
        var frame = 0;
        
        var ships = [];
        
        var plob = new Image();
        plob.src = "pics/ship.png";
        var lazer = new Audio("sfx/Arrow_Swoosh.wav");
                
        function all_ships(m) {
            var ship_id;
            for (ship_id = 0; ship_id < ships.length; ship_id++) {
                (ships[ship_id][m])();
            }
        }
        
        function draw() {
            frame++;
            var rem = frame % frameRate;
            //console.log((frame-rem)/frameRate + ":" + rem);
            // blankkaa ruutu
            c.save();
            c.clearRect(0, 0, c.canvas.width, c.canvas.height);

            c.translate(frame % 800, 200);
            c.rotate(Math.PI/2);
            c.translate(-plob.width/2, -plob.height/2);
            c.drawImage(plob, 0, 0);

            var plup = frame % (5*frameRate);
            if (plup < frameRate/1.5) {
                if (plup == 0)
                    lazer.play();
                
                var tgx = 100 + frame % 800 + 5*Math.random();
                var tgy = 200 + 5*Math.random();
                
                beam(c, 14, 20, tgx, tgy);
                beam(c, 26, 20, tgx, tgy);                
            }
            // piirrÃ¤ shipit
            all_ships("move");
            all_ships("draw");
            
            c.restore();
        }
        
        setInterval(function(){draw()}, 1000/50);

    }
    </script>
    

    
          

</head>
<body onload="run()">
    <div id="wrapper">
        <canvas id="canv" width="800" height="400"> </canvas>
    </div>
            
</body>